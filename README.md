# Extremal Volume Ellipsoids - Matlab

This repository include the function maxve that solves a semi-definite programming optimization problem in order to compute the ellipsoid of maximum volume inscribed within a given polytopic set. The full mathematical derivation can be found within the book [Convex Optimization](https://web.stanford.edu/~boyd/cvxbook/bv_cvxbook.pdf), the function has been coded in Matlab using the toolboxes [Yalmip](https://yalmip.github.io) and [MPT](https://www.mpt3.org) respectively for the optimization problem and to generate the plots in 2D and 3D. The optimization relies on the solver [SeDuMi](http://sedumi.ie.lehigh.edu). Note that installing [MPT](https://www.mpt3.org) will prompt for the installation of [Yalmip](https://yalmip.github.io) and [SeDuMi](http://sedumi.ie.lehigh.edu).

## Maximum volume ellipsoid inscribed in a polytope

The polytope in dimension <a href="https://www.codecogs.com/eqnedit.php?latex=n" target="_blank"><img src="https://latex.codecogs.com/svg.latex?n" title="n" /></a> is defined using a set of linear inequalities in the following way,

<a href="https://www.codecogs.com/eqnedit.php?latex=\large&space;\mathcal{P}&space;=&space;\left\{&space;x&space;|&space;Ax&space;\leq&space;b&space;\right\}" target="_blank"><img src="https://latex.codecogs.com/svg.latex?\large&space;\mathcal{P}&space;=&space;\left\{&space;x&space;|&space;Ax&space;\leq&space;b&space;\right\}" title="\large \mathcal{P} = \left\{ x \in \mathbb{R}^{n} | Ax \leq b \right\}," /></a>

where <a href="https://www.codecogs.com/eqnedit.php?latex=A&space;\in&space;\mathbb{R}^{m&space;\times&space;n}" target="_blank"><img src="https://latex.codecogs.com/svg.latex?A&space;\in&space;\mathbb{R}^{m&space;\times&space;n}" title="A \in \mathbb{R}^{m \times n}" /></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=b&space;\in&space;\mathbb{R}^{m}" target="_blank"><img src="https://latex.codecogs.com/svg.latex?b&space;\in&space;\mathbb{R}^{m}" title="b \in \mathbb{R}^{m}" /></a>. The inscribed ellipsoid <a href="https://www.codecogs.com/eqnedit.php?latex=\mathcal{E}" target="_blank"><img src="https://latex.codecogs.com/svg.latex?\mathcal{E}" title="\mathcal{E}" /></a> is parametrized as follows,

<a href="https://www.codecogs.com/eqnedit.php?latex=\large&space;\mathcal{E}&space;=&space;\left\{&space;Bu&space;&plus;&space;d&space;|&space;\left\lVert&space;u&space;\right\rVert_{2}&space;\leq&space;1&space;\right\}" target="_blank"><img src="https://latex.codecogs.com/svg.latex?\large&space;\mathcal{E}&space;=&space;\left\{&space;Bu&space;&plus;&space;d&space;|&space;\left\lVert&space;u&space;\right\rVert_{2}&space;\leq&space;1&space;\right\}" title="\large \mathcal{E} = \left\{ Bu + d | \left\lVert u \right\rVert_{2} \leq 1 \right\}," /></a>

where <a href="https://www.codecogs.com/eqnedit.php?latex=B" target="_blank"><img src="https://latex.codecogs.com/svg.latex?B" title="B" /></a> is a positive definite matrix. The optimization problem that maximizes the inscribed ellipsoid volume is formulated such that,

<a href="https://www.codecogs.com/eqnedit.php?latex=\large&space;\begin{align}&space;\underset{B,d}{\operatorname{minimize}}&space;\quad&space;&&space;\operatorname{log}\operatorname{det&space;\:&space;B^{-1}}&space;\nonumber&space;\\&space;\text{subject&space;to}&space;\quad&space;&&space;\forall&space;i&space;\in&space;\left\{1,&space;\ldots,&space;m\right\},&space;&&space;\nonumber&space;\\&space;&&space;\left\lVert&space;Ba_{i}&space;\right\rVert_{2}&plus;&space;a_{i}^{T}d&space;\leq&space;b_{i}&space;&&space;\nonumber&space;\end{align}" target="_blank"><img src="https://latex.codecogs.com/svg.latex?\large&space;\begin{align}&space;\underset{B,d}{\operatorname{minimize}}&space;\quad&space;&&space;\operatorname{log}\operatorname{det&space;\:&space;B^{-1}}&space;\nonumber&space;\\&space;\text{subject&space;to}&space;\quad&space;&&space;\forall&space;i&space;\in&space;\left\{1,&space;\ldots,&space;m\right\},&space;&&space;\nonumber&space;\\&space;&&space;\left\lVert&space;Ba_{i}&space;\right\rVert_{2}&plus;&space;a_{i}^{T}d&space;\leq&space;b_{i}&space;&&space;\nonumber&space;\end{align}" title="\large \begin{align} \underset{B,d}{\operatorname{minimize}} \quad & \operatorname{log}\operatorname{det \: B^{-1}} \nonumber \\ \text{subject to} \quad & \forall i \in \left\{1, \ldots, m\right\}, & \nonumber \\ & \left\lVert Ba_{i} \right\rVert_{2}+ a_{i}^{T}d \leq b_{i} & \nonumber \end{align}" /></a>
